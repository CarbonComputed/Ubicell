{% extends "base.html" %}

<html>
<head>
	{%block scripts%}
		<link rel="stylesheet" href="/static/styles/me.css" type="text/css" />

	{%end%}
</head>
<body>
	{%block container%}
	<div id="container">
		<div id="left-side-bar">

		</div>
		<div id="Main-Content">
			<div id="user-data">
				<div class="proimg">
					<img  src="/images?picid={{escape(userdata['ProfileImg']['$oid'])}}" height="150" width="150">
					<span class="changepro"><a href="/actions/changepro">Edit</a></span>
				</div>
				<div class="user-description">
					<h2>{{escape(userdata['FirstName']).capitalize()}} {{escape(userdata['LastName']).capitalize()}}</h2></br>
					<h3>{{escape(userdata['School']['Major'])}}, {{userdata['School']['GradYear']}}</h3>
					<p>About Me: {{escape(userdata['About'])}}</p>
				</br>
				<a href="Photos">Photos</a>
				<a href="Friends">Friends</a>
			</div>

		</div>
		<div class="clear"></div>
		<div id="Status">
			<form action="#" onsubmit="post();return false;">
				<textarea id="status_text" class="status_box" type="text" name="status" ></textarea>
				<input class="status_button" type="submit" value="Post!">
			</form>
		</div>
		<div class ="clear"></div>
		<div id="Status-Feed">
				{%for post in feed%}
<div id="Votes">
						{%set color = 'gray'%}
						{% if ObjectId(current_user['_id']['$oid']) in post['Wall']['Upvoters'] %}
							{%set color = 'orange'%}
						{%end%}
						<a style="color:{{color}};" href="#" onclick="vote(this,'up')" ><i style="color:{{color}};" class="icon-arrow-up"></i></a>

						<p>{{post['Wall']['Upvotes']-post['Wall']['Downvotes']}}</p>
						{%set color = 'gray'%}
						{% if ObjectId(current_user['_id']['$oid']) in post['Wall']['Downvoters'] %}
							{%set color = 'orange'%}
						{%end%}
						<a href="#" onclick="vote(this,'down')"><i style="color:{{color}};" class="icon-arrow-down"></i></a>
						<div class="clear"></div>

					</div>
				<div id="Status-sec" data-postid={{post['Wall']['id']}} data-ownerid={{post['_id']}}>
					<a href="/user/{{post['UserName']}}"><img src="/images?picid={{str(post['ProfileImg'])}}" href="/user/{{post['UserName']}}" height="52" width="52"></a>
					<div id="status-post">
						<a class="Name" href="/user/{{post['UserName']}}">{{post['FirstName'].capitalize()}} {{post['LastName'].capitalize()}}</a></br>
						<p class="post">{{post['Wall']['Message']}}</p>
						<a href="#" style="float:left;background:white;font-size:11px;padding-top:10px;color:black;">Load Comments</a>

					</div>

					<div class="clear"></div>

				</div>
				{%end%}

		</div>

	</div>
</div>
{%end%}
</div>
{%block funcs%}

<script type="text/javascript">

function post(){
		
		{% from constants import * %}
		var message = $('#status_text').val();
		var posttype = parseInt({{PostType.WALL_POST}});
		console.log(posttype);
		$.ajax({
			  type: "POST",
			  url: '/actions/post',
			  data: { 'message' : message, 'posttype' : posttype},
			  success: function(){ alert('success');
			  },
			  dataType: 'json'
			});
		var currpage = window.location.pathname;
		console.log(currpage);
		$('#status_text').val('');

		$('#Status-Feed').load('/user/{{userdata['UserName']}} #Status-Feed > *').hide().fadeIn('slow');

	
}
$('.changepro').hide();
$('.proimg').hover(function(){
    $('.changepro').show();
}, function() {
   $('.changepro').hide();
});
</script>

{%end%}
</body>
</html>